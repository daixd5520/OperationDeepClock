:root{
  --bg-color:#12121e;
  --card-color:#1e1e2f;
  --primary-text:#e0e0e0;
  --secondary-text:#a0a0b0;
  --accent-color:#00aaff;
  --progress-bar-color:#00f0c0;
  --heatmap-0:#2d2d44;
  --heatmap-1:#0e4429;
  --heatmap-2:#006d32;
  --heatmap-3:#26a641;
  --heatmap-4:#39d353;
  --bronze:#cd7f32;
  --silver:#c0c0c0;
  --gold:#ffd700;
  --diamond:#7df9ff;
}

body{
  font-family:'Noto Sans SC',sans-serif;
  background-color:var(--bg-color);
  color:var(--primary-text);
  margin:0;padding:20px;
  display:flex;justify-content:center;align-items:flex-start;
}
.app-container{width:100%;max-width:480px;}

/* Header */
header{text-align:center;padding-bottom:12px;margin-bottom:6px;}
header h1{font-family:'Orbitron',sans-serif;color:var(--accent-color);margin:0;}
header h1 sub{font-size:.5em;opacity:.7;}
.streak-counter{color:var(--progress-bar-color);font-weight:bold;margin-top:5px;}

/* Tabs */
.tabs{
  position:sticky; top:0; z-index:5;
  display:grid; grid-template-columns:repeat(5,1fr); gap:6px;
  background:var(--bg-color); padding:6px 0 10px; margin-bottom:10px;
}
.tab{
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.15);
  color:var(--primary-text);
  padding:10px 0; border-radius:10px; cursor:pointer;
  font-size:.95em; transition:all .15s;
}
.tab.active{
  background:linear-gradient(90deg,var(--accent-color),var(--progress-bar-color));
  color:#0b1220; font-weight:800; box-shadow:0 6px 16px rgba(0,0,0,.25);
}
.tab:hover{transform:translateY(-1px);}

.tab-panel{display:none;}
.tab-panel.active{display:block;}

main,.dashboard,.settings-card,.focus-card{
  background-color:var(--card-color);
  border-radius:20px; padding:25px; margin-bottom:25px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
  border:1px solid rgba(255,255,255,.1);
}

.day-info h2,.dashboard h2,.dashboard h3,.settings-card h3{text-align:center;}
.dashboard h3{font-size:1em;color:var(--secondary-text);margin-top:30px;margin-bottom:15px;}

.targets-card{
  display:flex;justify-content:space-around;
  background:rgba(0,0,0,.2);padding:15px;border-radius:10px;margin-bottom:20px;
}
.target{text-align:center;}
.target .label{display:block;font-size:.8em;color:var(--secondary-text);}
.target .time{font-size:1.8em;font-weight:bold;font-family:'Orbitron',sans-serif;}

.ritual-card{background:rgba(0,0,0,.2);padding:15px;border-radius:10px;}
.rituals-container{display:grid;grid-template-columns:1fr;gap:20px;margin-bottom:20px;}
.ritual-card h3{margin-top:0;text-align:center;color:var(--accent-color);}
.ritual-card ul{list-style-type:none;padding-left:0;margin:0;}
.checklist li{
  display:flex;align-items:center;padding:10px;margin-bottom:8px;
  background-color:rgba(0,0,0,.2);border-radius:8px;cursor:pointer;transition:background-color .2s;
}
.checklist li:hover{background-color:rgba(255,255,255,.08);}
.checklist input[type="checkbox"]{margin-right:12px;width:18px;height:18px;accent-color:var(--progress-bar-color);}
.checklist label{flex-grow:1;}
.checklist input[type="checkbox"]:checked+label{text-decoration:line-through;color:var(--secondary-text);}

.wakeup-logger{text-align:center;padding:10px 0;}
.wakeup-logger button{
  background:linear-gradient(45deg,var(--accent-color),var(--progress-bar-color));
  color:var(--bg-color);font-weight:bold;font-size:1.2em;padding:15px 30px;border-radius:10px;border:none;cursor:pointer;transition:all .3s ease;
  box-shadow:0 4px 15px rgba(0,240,192,.3);
}
.wakeup-logger button:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,240,192,.4);}
.wakeup-logger button:disabled{background:var(--heatmap-0);color:var(--secondary-text);box-shadow:none;transform:none;cursor:not-allowed;}
.wakeup-logger p{margin-top:15px;color:var(--secondary-text);}
.wakeup-logger p span{color:var(--primary-text);font-weight:bold;}

.progress-card{background:rgba(0,0,0,.2);padding:15px;border-radius:10px;text-align:center;margin-bottom:20px;}
.progress-bar-container{width:100%;background-color:rgba(0,0,0,.3);border-radius:10px;overflow:hidden;height:20px;margin-bottom:10px;}
.progress-bar{width:0%;height:100%;background:linear-gradient(90deg,var(--accent-color),var(--progress-bar-color));transition:width .5s ease-in-out;}

.combo-card{background:rgba(0,0,0,.2);padding:15px;border-radius:10px;text-align:center;margin-bottom:20px;}
.badge{
  display:inline-block;padding:8px 14px;border-radius:999px;background:rgba(255,255,255,.08);color:#fff;font-weight:bold;letter-spacing:.5px;border:1px solid rgba(255,255,255,.15);
}
.badge.bronze{background:linear-gradient(45deg,#553016,var(--bronze));color:#1b0f07;}
.badge.silver{background:linear-gradient(45deg,#4a4a4a,var(--silver));color:#111;}
.badge.gold{background:linear-gradient(45deg,#8d6b00,var(--gold));color:#231b00;}
.badge.diamond{background:linear-gradient(45deg,#1b3b4a,var(--diamond));color:#001a21;box-shadow:0 0 12px rgba(125,249,255,.5);}
.combo-desc{color:var(--secondary-text);margin-top:8px;}

/* Focus */
.focus-card h3{margin-top:0;text-align:center;color:var(--accent-color);}
.focus-weight{text-align:center;color:var(--secondary-text);}
.focus-windows{display:grid;grid-template-columns:1fr;gap:14px;margin-top:10px;}
.focus-window{background:rgba(0,0,0,.2);padding:12px;border-radius:10px;}
.focus-window h4{margin:0 0 6px 0;color:var(--progress-bar-color);text-align:center;}
.focus-window p{margin:8px 0 10px;text-align:center;font-family:'Orbitron',sans-serif;}
.toggle{display:flex;align-items:center;justify-content:center;gap:8px;}
.toggle input[type="checkbox"]{width:18px;height:18px;accent-color:var(--progress-bar-color);}
.focus-tip{margin-top:10px;text-align:center;color:var(--secondary-text);font-size:.9em;}

/* Dashboard */
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;text-align:center;margin-bottom:20px;}
.stat-item h4{margin:0 0 5px 0;color:var(--secondary-text);font-weight:normal;font-size:.9em;}
.stat-item p{margin:0;font-size:1.5em;font-weight:bold;color:var(--progress-bar-color);font-family:'Orbitron',sans-serif;}

.chart-container{position:relative;width:100%;height:250px;}
.chart-placeholder{
  position:absolute;top:0;left:0;width:100%;height:100%;
  background-color:rgba(0,0,0,.2);border-radius:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;
  text-align:center;color:var(--secondary-text);padding:20px;box-sizing:border-box;
}
.chart-placeholder p{margin:5px 0;}
.chart-placeholder p:first-child{font-size:2.5em;margin-bottom:10px;}

.heatmap-container{position:relative;display:grid;grid-template-columns:repeat(auto-fill,minmax(20px,1fr));gap:4px;}
.heatmap-container .chart-placeholder{grid-column:1/-1;height:150px;}
.heatmap-day{width:100%;aspect-ratio:1/1;border-radius:3px;background-color:var(--heatmap-0);position:relative;}
.heatmap-day.level-1{background-color:var(--heatmap-1);}
.heatmap-day.level-2{background-color:var(--heatmap-2);}
.heatmap-day.level-3{background-color:var(--heatmap-3);}
.heatmap-day.level-4{background-color:var(--heatmap-4);}
.heatmap-day .tooltip{visibility:hidden;opacity:0;position:absolute;bottom:120%;left:50%;transform:translateX(-50%);background-color:#111;color:#fff;padding:5px 10px;border-radius:5px;font-size:.8em;white-space:nowrap;transition:opacity .2s;z-index:10;}
.heatmap-day:hover .tooltip{visibility:visible;opacity:1;}

/* Settings */
.settings-card h3{text-align:center;color:var(--accent-color);}
.footer-actions{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(80px,1fr));gap:8px;align-items:center;justify-content:center;margin-top:10px;
}
.btn-ghost,.btn-danger,.btn-primary,.btn-small{
  background:none;border:1px solid rgba(255,255,255,.2);color:var(--primary-text);
  padding:8px 10px;border-radius:8px;font-size:.85em;cursor:pointer;transition:all .2s;text-align:center;
}
.btn-ghost:hover{background:rgba(255,255,255,.06);}
.btn-danger{border-color:#dc3545;color:#dc3545;}
.btn-danger:hover{background:#dc3545;color:#fff;}
.btn-primary{background:linear-gradient(45deg,var(--accent-color),var(--progress-bar-color));color:var(--bg-color);border:none;font-weight:bold;}
.btn-primary:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,240,192,.3);}
.btn-small{padding:6px 12px;font-size:0.8em;}
.btn-edit{border-color:var(--progress-bar-color);color:var(--progress-bar-color);}
.btn-edit:hover{background:var(--progress-bar-color);color:var(--bg-color);}
.as-button{display:flex;align-items:center;justify-content:center;}
.settings-tip{color:var(--secondary-text);font-size:.9em;margin-top:10px;}

.gh-grid{
  display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;
}
.gh-grid label{display:flex;flex-direction:column;gap:6px;font-size:.9em;color:var(--secondary-text);}
.toggle-row{grid-column:1/-1;display:flex;align-items:center;gap:8px;color:var(--primary-text);}
.toggle-row input{width:18px;height:18px;accent-color:var(--progress-bar-color);}

/* Toast */
.toast{
  position:fixed;right:16px;top:16px;background:rgba(0,0,0,.85);color:#fff;padding:10px 14px;border-radius:10px;opacity:0;pointer-events:none;
  transform:translateY(-10px);transition:opacity .2s,transform .2s;z-index:9999;border:1px solid rgba(255,255,255,.1);
}
.toast.show{opacity:1;transform:translateY(0);}

/* 成就系统样式 */
.achievement-stats{
  background:rgba(0,0,0,.2);padding:15px;border-radius:12px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;
}
.achievement-stats .stat-item{display:flex;flex-direction:column;align-items:center;}
.achievement-stats .stat-label{font-size:.8em;color:var(--secondary-text);margin-bottom:3px;}
.achievement-stats .stat-value{font-size:1.2em;font-weight:bold;color:var(--progress-bar-color);font-family:'Orbitron',sans-serif;}
.achievement-stats .progress-bar{width:100%;height:6px;background:rgba(255,255,255,.1);border-radius:3px;overflow:hidden;margin-top:5px;}
.achievement-stats .progress-fill{height:100%;background:linear-gradient(90deg,var(--accent-color),var(--progress-bar-color));transition:width .5s ease;}

.achievements{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:15px;}
.ach-card{
  background:rgba(0,0,0,.2);border-radius:12px;padding:15px;border:1px solid rgba(255,255,255,.1);
  display:flex;gap:12px;align-items:flex-start;transition:all .3s ease;position:relative;overflow:hidden;
}
.ach-card.unlocked{
  background:rgba(0,255,200,.1);border-color:rgba(0,255,200,.3);box-shadow:0 0 20px rgba(0,255,200,.2);
}
.ach-card.locked{opacity:0.7;}
.ach-card:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(0,0,0,.4);}

/* 稀有度边框颜色 */
.ach-card.rarity-common{border-color:rgba(76,175,80,.3);}
.ach-card.rarity-common.unlocked{background:rgba(76,175,80,.1);border-color:rgba(76,175,80,.6);}
.ach-card.rarity-rare{border-color:rgba(33,150,243,.3);}
.ach-card.rarity-rare.unlocked{background:rgba(33,150,243,.1);border-color:rgba(33,150,243,.6);}
.ach-card.rarity-epic{border-color:rgba(156,39,176,.3);}
.ach-card.rarity-epic.unlocked{background:rgba(156,39,176,.1);border-color:rgba(156,39,176,.6);}
.ach-card.rarity-legendary{border-color:rgba(255,193,7,.3);}
.ach-card.rarity-legendary.unlocked{background:rgba(255,193,7,.1);border-color:rgba(255,193,7,.6);box-shadow:0 0 30px rgba(255,193,7,.3);}
.ach-card.rarity-secret{border-color:rgba(244,67,54,.3);}
.ach-card.rarity-secret.unlocked{background:rgba(244,67,54,.1);border-color:rgba(244,67,54,.6);}

.ach-icon{
  width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;background:rgba(255,255,255,.1);
  flex-shrink:0;transition:all .3s ease;
}
.ach-card.unlocked .ach-icon.icon-unlocked{
  background:linear-gradient(135deg,var(--accent-color),var(--progress-bar-color));animation:pulse 2s infinite;
}
.ach-checkmark{
  position:absolute;top:8px;right:8px;width:24px;height:24px;background:var(--progress-bar-color);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:bold;font-size:14px;animation:checkmarkPop .4s ease-out;
}

.ach-body{flex:1;min-width:0;}
.ach-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px;}
.ach-name{font-weight:bold;color:var(--primary-text);font-size:.95em;margin:0;}
.ach-points{font-size:.8em;color:var(--progress-bar-color);font-weight:bold;background:rgba(0,255,200,.1);padding:2px 6px;border-radius:4px;}
.ach-desc{font-size:.85em;color:var(--secondary-text);line-height:1.3;margin-bottom:8px;}

.achievement-progress{margin-top:8px;}
.achievement-progress .progress-bar{width:100%;height:4px;background:rgba(255,255,255,.1);border-radius:2px;overflow:hidden;margin-bottom:4px;}
.achievement-progress .progress-fill{height:100%;background:linear-gradient(90deg,var(--accent-color),var(--progress-bar-color));transition:width .3s ease;}
.achievement-progress .progress-text{font-size:.75em;color:var(--secondary-text);text-align:right;}

.ach-rarity{font-size:.8em;color:var(--secondary-text);display:flex;align-items:center;gap:4px;}

/* 成就解锁动画 */
@keyframes achievementUnlock{
  0%{transform:scale(0.8);opacity:0;}
  50%{transform:scale(1.05);opacity:1;}
  100%{transform:scale(1);opacity:1;}
}
@keyframes pulse{
  0%,100%{box-shadow:0 0 10px rgba(0,255,200,.5);}
  50%{box-shadow:0 0 20px rgba(0,255,200,.8);}
}
@keyframes checkmarkPop{
  0%{transform:scale(0) rotate(-180deg);opacity:0;}
  50%{transform:scale(1.2) rotate(10deg);opacity:1;}
  100%{transform:scale(1) rotate(0);opacity:1;}
}

/* 历史记录管理样式 */
.history-manager{
  background:var(--card-color);border-radius:20px;padding:25px;margin-bottom:25px;
  box-shadow:0 10px 30px rgba(0,0,0,.3);
  border:1px solid rgba(255,255,255,.1);
}

.history-manager h2{
  text-align:center;color:var(--accent-color);margin-top:0;margin-bottom:20px;
}

.history-controls{
  display:flex;flex-direction:column;gap:10px;margin-bottom:20px;
}

.history-controls > div{
  display:flex;gap:10px;align-items:center;flex-wrap:wrap;
}

.history-controls input[type="text"]{
  flex:1;min-width:200px;padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:8px;
  background:rgba(255,255,255,.05);color:var(--primary-text);font-size:.9em;
}

.history-controls select{
  padding:10px;border:1px solid rgba(255,255,255,.2);border-radius:8px;
  background:rgba(255,255,255,.05);color:var(--primary-text);font-size:.9em;
}

.history-list{
  display:flex;flex-direction:column;gap:10px;max-height:400px;overflow-y:auto;
}

.history-item{
  background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:15px;
  display:flex;justify-content:space-between;align-items:center;transition:all .2s ease;
}

.history-item:hover{
  background:rgba(255,255,255,.08);transform:translateX(2px);
}

.history-date{
  display:flex;flex-direction:column;gap:2px;min-width:100px;
}

.date-text{
  font-weight:bold;color:var(--primary-text);font-size:.95em;
}

.date-day{
  font-size:.8em;color:var(--secondary-text);
}

.history-summary{
  display:flex;gap:15px;align-items:center;flex:1;
}

.summary-item{
  display:flex;flex-direction:column;align-items:center;gap:2px;
}

.summary-item .label{
  font-size:.7em;color:var(--secondary-text);text-transform:uppercase;
}

.summary-item .value{
  font-size:.9em;font-weight:bold;color:var(--primary-text);
}

.summary-item .value.completed{
  color:var(--progress-bar-color);
}

.summary-item .value.missing{
  color:var(--secondary-text);
}

.delta-t{
  font-family:'Orbitron',sans-serif;
}

.delta-0{color:var(--secondary-text);}
.delta-1{color:var(--heatmap-1);}
.delta-2{color:var(--heatmap-2);}
.delta-3{color:var(--heatmap-3);}
.delta-4{color:var(--heatmap-4);}

.history-actions{
  display:flex;gap:8px;
}

/* 模态框样式 */
.modal{
  display:none;position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,.8);z-index:1000;align-items:center;justify-content:center;
  opacity:0;visibility:hidden;transition:all .3s ease;
}

.modal.show{
  display:flex;opacity:1;visibility:visible;
}

.modal-content{
  background:var(--card-color);border-radius:20px;width:90%;max-width:500px;max-height:90vh;overflow-y:auto;
  border:1px solid rgba(255,255,255,.1);box-shadow:0 20px 60px rgba(0,0,0,.5);
  transform:scale(0.9);transition:transform .3s ease;
}

.modal.show .modal-content{
  transform:scale(1);
}

.modal-header{
  display:flex;justify-content:space-between;align-items:center;padding:20px 20px 10px;border-bottom:1px solid rgba(255,255,255,.1);
}

.modal-header h3{
  margin:0;color:var(--primary-text);font-size:1.2em;
}

.modal-close{
  background:none;border:none;color:var(--secondary-text);font-size:1.5em;cursor:pointer;padding:0;width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .2s ease;
}

.modal-close:hover{
  background:rgba(255,255,255,.1);color:var(--primary-text);
}

.modal-body{
  padding:20px;
}

.form-group{
  margin-bottom:20px;
}

.form-group label{
  display:block;margin-bottom:8px;color:var(--primary-text);font-weight:bold;
}

.form-group input[type="date"],
.form-group input[type="time"]{
  width:100%;padding:12px;border:1px solid rgba(255,255,255,.2);border-radius:8px;
  background:rgba(255,255,255,.05);color:var(--primary-text);font-size:1em;
}

.modal-checklist{
  display:flex;flex-direction:column;gap:8px;
}

.modal-checklist-item{
  display:flex;align-items:center;gap:10px;padding:8px;background:rgba(255,255,255,.05);border-radius:6px;
}

.modal-checklist-item input[type="checkbox"]{
  width:18px;height:18px;accent-color:var(--progress-bar-color);
}

.modal-checklist-item label{
  flex:1;margin:0;font-weight:normal;font-size:.9em;
}

.focus-toggles{
  display:flex;flex-direction:column;gap:10px;
}

.modal-footer{
  display:flex;justify-content:space-between;align-items:center;padding:10px 20px 20px;border-top:1px solid rgba(255,255,255,.1);
}

.modal-actions{
  display:flex;gap:10px;
}

/* 响应式设计 */
@media (max-width:480px){
  .tabs{
    grid-template-columns:repeat(3,1fr); /* 5个标签在手机上变成3列 */
  }

  .tab{
    font-size:.8em;padding:8px 0;
  }

  .achievements{grid-template-columns:1fr;}
  .achievement-stats{flex-direction:column;gap:8px;text-align:center;}
  .ach-card{padding:12px;}
  .ach-icon{width:40px;height:40px;font-size:20px;}

  .history-controls{
    flex-direction:column;
  }

  .history-controls > div{
    flex-direction:column;align-items:stretch;
  }

  .history-item{
    flex-direction:column;align-items:flex-start;gap:10px;
  }

  .history-summary{
    width:100%;justify-content:space-around;
  }

  .modal-content{
    width:95%;margin:10px;
  }

  .modal-footer{
    flex-direction:column;gap:15px;align-items:stretch;
  }

  .modal-actions{
    justify-content:center;
  }
}
